language: ruby
env:
  matrix:
  - DOCKER_COMPOSE_VERSION=1.24.1
  global:
  - secure: mqiRMZXV/Q+u19yvKkjFZ9Fi0cR+qYz9r0N4H11LkXzqTmC1i6UTbuk02pJIF8gBdavKgrvRaw6z4UTw0V/3zoTBmeTOzdgeB4t7PNIniG3AHBTUeNTNk2PjuyW9DwTsajVrCOsZzYLc6aIYZra0PtAZUp+NyYaJPhh3RLtoEwoZQ9CH69OMVNMd7ODGV456sLrfmY11bxmymEhhF82O6fz/4hK6HLkMtAfj8l5zp+VL3cQh127TisEpgYLEXfT6i8iC0nYrcry7KzkRUpYk/C4gfoFHyPHIr5fw3Br1FBukkiO0BfGtFTL15XGR7EkEliS3GBfQIVt0GSyp0sCh2CjzTpPnUXVMsQuvV1MHCo43ouWeL4z6OvcAgZdy4y4GIJAq7siTj8LCgC/Up1K82Ey2JIogCAM2C41HYYDTojvRBGje+uKvNiMDwpV+QNzBcpOyIbYjMMnSRzbk9H8zgKyLh8P6/mW3a0EU9dFjvXfYEvZszOfatzh2F3YuBRaffZ4O5VE7p9QSRUNU4WqsGNVlTuWISBPZW8tCaZ3bZzkl7eZWl13Km/sASVpDra1nwjQZ9RESRgaOHe4kC4l036BzsFIjzZa60yE//y+Q0qJEBUFYSsIRgHpasRVxODtpjmxPMjCPa9iPMUdKvutvocv2YImALGtzT7DICbewS8o=
  - secure: Nh4KDevQNvx1qnLv5S43OeQe/RYggk7FJ+iqDLPcgNFfSSzg1fm9WrB57WqgGA4eKexKEW4livpnhiHDCTDof+XdPfyMqoOgN6lKDL2Qdk2KTf16zvJI2ZboEp2pZMqSUQr5ne+tvZ1W6pkcRE4RDMfFknYMqLsASKCmMU0QOyZmqMCxrAHDPEWT0aCu+l3W/NK7uY9lswHGIwxgojyq0RLyXm47WxKkWR1ga3iFItCyYwteCD8HEGkJIDtf1rY6zl4Re9uTDG3JTZGMsvE1JmcV1t71DKmheqKMngYwTcTfMpI/zsreruStwlAT7+1rNxW4Nts1LQ7ViuNRW/MSNQ06XxfpSuNM+QYgNBcisgI29qwzAdTq8S51hO1JFdxdIPczdEnbcVDYiAn2ppOnaeSsg/NK05Eoiq3n7LswY8NxNVkc9NxKvEPW17hdfH0nTIsD6QOJtelatykIVWb+Q2P0iQjTzee/ZgqXY3RISg+fkrnaGv/Dbho12LPMfkWRlpgcmEK+4tB3nB9c2KsQqrD7AFgCWXtb5olSLQifjWp+9OnFcgwXAZnmTYonXNogLm7pdj+pRqGZCvC6JTg9lJNLVVl08ma66AEG3fezQCDdekySfUtHFkChy+0TK46RCA/2A+KTdl0khj0H94+BsacMADw/TMfVLgzVGXwbqYI=
  - secure: 1zfHWD/jP3Ike8A1zCvhe4ZRzX96HtUv3YM4gyrlyfrrNi3DzoPQbS00xyE245lwYhwt6ugoUgEEJEqdE9BiX1UFw2cL+7KEjV+h2oC6jhbp9kpEHCRctrJjRdJ9RAdkH976A+BDHgcv2rHnhas6D/a6/SYxapm2QrM0Ou3kOAWfYRy4hfTWO9UtuHpv51Er4IrD3T/gv3FFhOfZHmwlJRaguE1+5J4qTT8qWRWEWusK+miTK8FDB6mgwsop28/f1CdmnKtPQZ1/cCyatmbjwLs5JlyLdYI+1m9fJY2205QSJW3JZGWJP5733I3OIM6+ElPJ0+xw/qsHP44DSMordq+9fSMLopQVZQ3vLfalprm0w3CqMH7wYsBC6xje4rDtq1iNk2EE/NwbpBf73IphAdioQZLedVEVCKC7ZKtpoyzbwnnjfT/aMkO/kSUmamZUvjHMpcQ4H2a6Tw3w7j3AgHU7pgyVAYo+lL/edCvVhaEdqQYqIXpSeIfeILVEvtIq71LBOkRkd8BacKt32AKGXIopuaZBV4d81NlJoeKzYGpa1iCsMw4bF8q3kNqIUefKTS9ORnY0AEE686PEqQ+zHVuIr9YP+BPrHtdRRq8jONSsiLaZiFuYDnVRil7xUHXDUqSItjclMIjlO/SxRJ5P1TRQUKUl1AqjSnfdmnCdXqU=
  - secure: yIyLomCtr6z84zJlDv5eWyB0/jNzrhB5hUhM1O7SZ7hTec2QFEA3+rFGlxlh6cYNlnhIfwVmAKBnf2kqRcbGlqVnPTZ7JaP4nnulfTlHcLDN08W5dcj4Em2Sr8xMBHYwgM4zVDAPBNVxhCtF+cGkBEeL2PHcUj03lyRzFB6KgZxVvlRL4zB/vX5W/mWg8JN5ERnF2SFkH6lPiwUU73yFfV8j1y0a43b+UB9II+tDtTPysUjWSSDTRjLPlnsW3Mq/1RsmNQYHR7jAzJDTueY5LYKrWyaNxwVQxKvjT1EB/nAzhF2AofQu/SbWGs3Kp12bUYg+JySjJs7wt/+1JJgu7rj5l7N+5PL8JjnvmZVmf5fYqpJpSrfko0uQCpeadkcy1PgZ06W72SDnaXEERp/LhqZWkvQ2lCs3+obuJA2wNf9T8dKz/EsyTB9y+vrwMRslgRwT9gbvImhBe3Z1oypzlHFNhINPpH1V5L4/0w4T70QmCcHIe7S9FXmGliyfXWbFb3K2su6YbUuILhQFdfQgh0zyzPC1nfYLAmSwU+GG38T5W0LppAZTAtTgENdTaOVsLLX59HAsEHYvRfKp2OHF9aA1ckHxQ5yZuTNCEtk6/XnB0efR6HQBE2DOmFPweqWy3kr3YVXG/1rZatNa5n4BtkolGPQIVukV9+Y4nZdpG8Y=
  - secure: EqfJrLzIHAS1Z31odddDdpSvC31xfoJOAXZTEJEoILzscRGsUHVa2imWaa15XMVUYYYQxtxuEdL3YQ4cPg4i3YsF4F1o5lLblU3xzYL0PBfWk+EW0yGptGQMV4L2Yn4VmXRJ9w1sKdK6SbWuCwFBiorHT4aVYatF6XGxxKY3oP/9jdjjx5VZa7s3Ptpu9cGJP+KQZPCTRtrhALQPfgBFvJELaTM2/hxhD3tzJ/GotiPAiy1ij14+GYJeZQg4+yKB4Oi7RMMU6szBRFuBN8yFZj8PPMZOfH6cQ1jvGBLnUvxmWs0veHrf2h/malb/8fDSKpHIbcOfb0Aw2gojBJ+5oYKISSc96k29i2hZX+saFCODQ3rdOBaDjHf2jJ9PSx9ZSSH1sZGkN54tXCc6ICjQkNbEeUzWtWi1omqzE91VPfttGwNFREQC5sgLnFNxcfC66iEbs2Hu32qEdj+0wk2ZfIFhGARe92NwrhgEwalWQkYNyI0209oGogOB2jlv2vY/JU9eRIUs71f4U3un9POBIK3j9wy5iEclY1XmSmsd4AGRhmFoJMcaklm95t0cruyl8yU7nLmtl0V1flXCqicrMIlQSvakFoQ7aD5Aaa4Q2Kmtk2B3lpgJH0URq3rR6euNtLFBzjGXKzM+rd0nEG+4X6f3sWAMmtl6y7418LgFnxU=
  - secure: TaJu4Wcas5NINpODGWVEftnJtf51jQMDYxwKcAQl3lcW+KiaVLpwqALCST/020ILXTWMt3GiEdrly+2wxMOpe7UDgwHkEL4vOsRdB3uzpHTcPC/6wwdy9NQFBowQDsH2xvTLfczsxCzrrGpgqYLRNxKMCQqFllL4dF6GHGoDxXFbDsKljSO2VK8ifqlyfI1zW8lki2yhSQL9QDaEpWJ4UIjkPjMSFBFrFeMMNugg3v5SXrIG4iGFKZguZc08dDUX2kvSWDHuynSMJ13KP6IQrNJV2Cf0rriBcC2iO4kdHYpTDzseHtuEdP7Oz/kg8Sqm+MVizCkLijrgFBXUZyJ6M7kBu3DvXyL5V6HGYq4QjXxWynmILEddiK/+1VVEiDrvGcPRsu/X0FbtI+7Ugiv4p5JoeFXWlWsA5oLMd8h3BkXByi/ROhcoQG4hI0NmTVfw4F+46AeKaMoVi7IWjIIr5F1wPyi0E3Mk17+FlxnZrpsHOE2h/USPZCR06aq2dcoC1HO0E+SVMcEJg2cJjVDRD0Yy+LMAPWnQDE5FLDo89VsT8eHnKDwLPqExXClyuUsG01lDlN5DupKcfGHn5mgGslcbpsfqDdQMf5pa4M9ary3GDEVbFdIcmviLXfV3qR45wRxP5uZ3yILQ7W1pW3fo5xrGYF7HFOcZgFDM1UiGJvk=
  - secure: l3FrJxQwiI0PvNfsI9MnPF05EDjFwpmsbmYQHjy56MXtqRcFSvh9Qb1GdxmvJpZqMsyPppNMSrFSOs+hIY1EAf9XdrCAmLsJwcgMnA/lSgozCOqsCykhdFh1IakQU1mEhduAomulUYGQGrOoFOfjgg89+hKfOzz5KywdIQxA54OnP3oBqkitrccD/XJrGwdCTcZFeLmvAYtV1umOc03RwuGhi0tq8/L2GzqI0q2OYtCj2RKhlgKdEAnZqOgbBFmjh716dOI3xEXqDHVsEbXcvsD1K559tGrnwU9CogRsqvB3viO4GFTVHn4yK30nx22l8LACvYCN2T1xYIuU/tZapqzZOUIQdJj/lRGAZbb+6HazF6kkOTcAbdYEyxd/Gnlwx+rm+BLsR/xR/j4kKo2pqZ+yDAgigV/vbXz01d+MklNJzUBZPFJBoh6Bx33D3ydH/6ZaxT+d+bWhFLQ8/zj0c+JKhc6/aLAtjBf20OOdfu2GSwmSoNe9Jdj5sEKGAvZjggpIG/fockO+mHg0mOkkXgkbHLY0MMRYy/5eGLc7K7RDec+Rw13jPPk1LqqZGX/DqxbAdYUBYB6fNwdp8GGmLHZaVDm3qpz7EmipwfNlif9OJ9p8C/noEhta/iT+tXJoH0enO6+OVqOIPEAGdZd7/K5bwRNOyv5Dw6LaAMSzHxs=
  - secure: DZ4dwQ1t7daLaL6XfCibiC31Z1I7InoBNlRQGOllu8ZjkBew8rILGKGiYG2EMSwk99tQ66i/xzAi5+1ZnR6Y+pNV0EMpKpsjuwV1vsqTOFLZZSnkZ393uCsq7+pn7WQIf08B2qJ9a9Qz4j0aL6tHMx2uYBw6pl8PQRAD9BLjErc3W5OW1JhusmkRJsYU36E7mkjFG7dACpvlT1lDv/B64is5M84SYwzPdMa9ai8ntAbQiGWx+ZCqk+YM1C9QZ6F7xb8sK7fJh3m2rOPB8ewPYIgQ3COwZskVAzSZauJdmFO5BnnabhI+ejI3qtI4fQgA+TTFlqzlWRZcJ53iTrA5X0g3NxTF7B42ToMoEgQ+Bgycoa9c0uNDhKe9GRK1sEho9d5I4UCJlvRlIGPuZuah9nISLI5ETL+URMGKmW2OmleRmv9/tnORW0hqVKu0wuvM4nh2Q73t+2kXkIbj0fzwUS2kk/ZtlcZ8ChQlYt/UufgMfL1c2HHwwnhYtT0czOP4ekOiFDT/DE/8VvWOvhgrLUI5Pr5w2RL3ocg1+0rf6IiJ3vcpXMLRuMpL54fKJHgrDxCgzQBIy87YXd4wRItiOkm7CdiR1gQJDaH5nlqhA4E2LDBcsnJqRbhLoo5YMx0C28DPy4rgeQuJNEXoQsItNVf5V0owMB+DX2Upe61DxiA=
  - secure: p2zSFCI1IlbDQSm+KECtFQhq3R1uzs5rRa+vyLAYTKJAaXa7GKD424Tc0Nw41NOARrbPWaUv4mvGXLUzyHSB9KOLjdQj/UqPsNcF6cIx2ydAA3BxGhQN6TNtX1h3EbJPBnh006GZluTSNzxkKrqi8Wn06rzaJUNDSuN2QGsVC7d1x8V9XGAgcaohPbO+2LIBq+GLYQCxiLB3/Ha2tCzQm9pKsd3kCd3irUWnpIz9gwLZ1YiSD2QRD8xy6tQQw2nsxKywnyrthgnGW6C1nCdbzUj8I4luV/IeISNi+13b5CSrHkK7EKlENeTb0vIynQ+L0D9wuMY9loeV65aB0N3ERJ/LWOVsLCKHbs3bQ6X+akmvwnold+G0QAlHjRmg6LiG+pBG/tvElddIoLEWq1bSWTT0shrNUDgInQ98CvNOKh3Rg9eTD2FnZDnk8YO4nQbWiT7jUOet8Ga41Rc2UvuE7yg+Kc1BEEbu3Vh1enX4XgCZfrrqk2nKL4ZmLcX5oeNol0wMvbqFykU9iM4sJQEFLAbFCvuZjXBzufTmURDShr+VdZ5VFOZ/HZD+fc+JGHOSwgUeaR7QmbmD0OiFWxAl1jyOyIxoc1FYWLp5qUsnz416ijnllI9f1PFUltCOjGdt9bto7oubb/l88sa3rmFRCUahi8lQQAtVp0GdBSuwJYU=
before_install:
- sudo rm /usr/local/bin/docker-compose
- curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname
  -s`-`uname -m` > docker-compose
- chmod +x docker-compose
- sudo mv docker-compose /usr/local/bin
install:
- docker-compose build
before_script:
- docker-compose up -d
- sleep 10
- docker ps -a
cache:
  directories:
  - node_modules
script:
- curl localhost
- curl localhost/api/v1
after_script:
- docker-compose down
deploy:
  provider: elasticbeanstalk
  access_key_id:
    secure: "$AWS_ACCESS_KEY_ID"
  secret_access_key:
    secure: "$AWS_ACCESS_KEY_SECRET"
  region: "$AWS_REGION"
  app: "$AWS_EB_APPLICATION"
  env: "$AWS_EB_ENVIRONMENT"
  bucket_name: "$AWS_EB_S3_BUCKET"
